(()=>{const e=document.querySelectorAll('div[ng-repeat="q in qt.qlist"]:not([style="float: left;"]):is(.ng-scope)'),t=document.querySelectorAll('.btn:is(.ng-binding):not(.ng-hide):not([id*="sendAns"])');let l=0;const n=[],o=[],r={},c=function(e,t){let l=Array(e.length+1).fill(null).map((()=>Array(t.length+1).fill(0)));for(let e=0;e<l.length;e++)l[e][0]=e;for(let e=0;e<l[0].length;e++)l[0][e]=e;for(let n=1;n<l.length;n++)for(let o=1;o<l[0].length;o++)l[n][o]=Math.min(l[n-1][o]+1,l[n][o-1]+1,l[n-1][o-1]+(e[n-1]!=t[o-1]?1:0));return l[l.length-1][l[0].length-1]},f=function(e,t=null){const r=t??e.querySelector('p[ng-bind-html="q.q | trustedHtml"]').innerHTML,f=e.querySelectorAll('span[ng-click="qt124Sel(option.value)"]');let s=!1;for(let e of f)try{for(let t of answer[r])t==e.innerHTML&&(e.click(),s=!0)}catch(e){}if(!s){l++;let e=Number.MAX_SAFE_INTEGER,t=null;console.log(`正在對該題目搜尋選項 : ${r}`);for(let l of f)try{for(let n of answer[r]){let o=c(n,l.innerHTML);o<e&&(e=o,t=l)}}catch(e){l++}t&&(s=!0,t.click())}s?n.push(r):o.push(e)};for(let t of e)f(t);for(const e of Object.keys(answer))n.includes(e)||(r[e]=answer[e]);for(const e of o){const t=e.querySelector('p[ng-bind-html="q.q | trustedHtml"]').innerHTML;console.log(`正在搜尋題目 : ${t}`);let l=Number.MAX_SAFE_INTEGER,n=null;for(const e of Object.keys(r)){let o=c(e,t);o<l&&(l=o,n=e)}f(e,n)}l&&alert(`填入完畢 共有 ${l} 題作答可能錯誤！`);for(const e of t)e.click()})();
